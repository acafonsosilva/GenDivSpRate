?gsub
set <- seqDNA[str_detect(names(seqDNA), paste(dtset$sample, collapse = "|"))]
library(ggplot2)
library("grid")
# !!! CONFIGURE YOUR PLOT HERE !!!
# Output
my_output <- paste("Maeg/","busco_figure.png",sep="/")
my_width <- 20
my_height <- 15
my_unit <- "cm"
# Colors
my_colors <- c("#56B4E9", "#3492C7", "#F0E442", "#F04442")
# Bar height ratio
my_bar_height <- 0.75
# Legend
my_title <- "BUSCO Assessment Results"
# Font
my_family <- "sans"
my_size_ratio <- 1
# !!! SEE YOUR DATA HERE !!!
# Your data as generated by python, remove or add more
my_species <- c('Maeg_wtdbg2_polca_Ratatosk', 'Maeg_wtdbg2_polca_Ratatosk', 'Maeg_wtdbg2_polca_Ratatosk', 'Maeg_wtdbg2_polca_Ratatosk', 'Maeg_Wtdbg2_Wtdbg2Suggested_Polca', 'Maeg_Wtdbg2_Wtdbg2Suggested_Polca', 'Maeg_Wtdbg2_Wtdbg2Suggested_Polca', 'Maeg_Wtdbg2_Wtdbg2Suggested_Polca', 'Maeg_masurca_polca_Ratatosk', 'Maeg_masurca_polca_Ratatosk', 'Maeg_masurca_polca_Ratatosk', 'Maeg_masurca_polca_Ratatosk', 'Maeg_canu_polca_Ratatosk', 'Maeg_canu_polca_Ratatosk', 'Maeg_canu_polca_Ratatosk', 'Maeg_canu_polca_Ratatosk')
my_species <- factor(my_species)
my_species <- factor(my_species,levels(my_species)[c(length(levels(my_species)):1)]) # reorder your species here just by changing the values in the vector :
my_percentage <- c(70.6, 0.2, 5.8, 23.4, 79.7, 0.3, 3.3, 16.7, 83.3, 1.0, 2.0, 13.7, 90.8, 2.3, 2.2, 4.7)
my_values <- c(4232, 9, 346, 1404, 4772, 16, 196, 1007, 4991, 58, 120, 822, 5440, 139, 129, 283)
######################################
######################################
######################################
# Code to produce the graph
labsize = 1
if (length(levels(my_species)) > 10){
labsize = 0.66
}
print("Plotting the figure ...")
category <- c(rep(c("S","D","F","M"),c(1)))
category <-factor(category)
category = factor(category,levels(category)[c(4,1,2,3)])
df = data.frame(my_species,my_percentage,my_values,category)
df
getwd()
write.table(df, '/Users/acas/Dropbox/Post-docs/Roux_Lab/genome_assembly/BUSCO_summaries_2polished/buscoOut.txt', quote = F, col.names = T, row.names = F)
?write.table
# Load the required libraries
library(ggplot2)
library("grid")
# !!! CONFIGURE YOUR PLOT HERE !!!
# Output
my_output <- paste("Mibe/","busco_figure.png",sep="/")
my_width <- 20
my_height <- 15
my_unit <- "cm"
# Colors
my_colors <- c("#56B4E9", "#3492C7", "#F0E442", "#F04442")
# Bar height ratio
my_bar_height <- 0.75
# Legend
my_title <- "BUSCO Assessment Results"
# Font
my_family <- "sans"
my_size_ratio <- 1
# !!! SEE YOUR DATA HERE !!!
# Your data as generated by python, remove or add more
my_species <- c('Mibe_wtdbg2_polca_Ratatosk', 'Mibe_wtdbg2_polca_Ratatosk', 'Mibe_wtdbg2_polca_Ratatosk', 'Mibe_wtdbg2_polca_Ratatosk', 'Mibe_masurca_polca_Ratatosk', 'Mibe_masurca_polca_Ratatosk', 'Mibe_masurca_polca_Ratatosk', 'Mibe_masurca_polca_Ratatosk', 'Mibe_canu_polca_Ratatosk', 'Mibe_canu_polca_Ratatosk', 'Mibe_canu_polca_Ratatosk', 'Mibe_canu_polca_Ratatosk', 'Mibe_Wtdbg2_Wtdbg2Suggested_Polca', 'Mibe_Wtdbg2_Wtdbg2Suggested_Polca', 'Mibe_Wtdbg2_Wtdbg2Suggested_Polca', 'Mibe_Wtdbg2_Wtdbg2Suggested_Polca', 'Mibe_raven_polca_Ratatosk', 'Mibe_raven_polca_Ratatosk', 'Mibe_raven_polca_Ratatosk', 'Mibe_raven_polca_Ratatosk')
my_species <- factor(my_species)
my_species <- factor(my_species,levels(my_species)[c(length(levels(my_species)):1)]) # reorder your species here just by changing the values in the vector :
my_percentage <- c(88.6, 0.2, 2.8, 8.4, 81.4, 1.3, 2.2, 15.1, 91.5, 0.7, 2.0, 5.8, 92.2, 0.3, 1.5, 6.0, 87.7, 0.4, 4.5, 7.4)
my_values <- c(5310, 11, 170, 500, 4875, 79, 133, 904, 5483, 41, 120, 347, 5521, 15, 87, 368, 5252, 21, 268, 450)
######################################
######################################
######################################
# Code to produce the graph
labsize = 1
if (length(levels(my_species)) > 10){
labsize = 0.66
}
print("Plotting the figure ...")
category <- c(rep(c("S","D","F","M"),c(1)))
category <-factor(category)
category = factor(category,levels(category)[c(4,1,2,3)])
df = data.frame(my_species,my_percentage,my_values,category)
write.table(df, '/Users/acas/Dropbox/Post-docs/Roux_Lab/genome_assembly/BUSCO_summaries_2polished/buscoOut.txt', quote = F, col.names = T, row.names = F, append = TRUE)
# Load the required libraries
library(ggplot2)
library("grid")
# !!! CONFIGURE YOUR PLOT HERE !!!
# Output
my_output <- paste("Mtar/","busco_figure.png",sep="/")
my_width <- 20
my_height <- 15
my_unit <- "cm"
# Colors
my_colors <- c("#56B4E9", "#3492C7", "#F0E442", "#F04442")
# Bar height ratio
my_bar_height <- 0.75
# Legend
my_title <- "BUSCO Assessment Results"
# Font
my_family <- "sans"
my_size_ratio <- 1
# !!! SEE YOUR DATA HERE !!!
# Your data as generated by python, remove or add more
my_species <- c('Mtar_raven_polca_Ratatosk', 'Mtar_raven_polca_Ratatosk', 'Mtar_raven_polca_Ratatosk', 'Mtar_raven_polca_Ratatosk', 'Mtar_canu_polca_Ratatosk', 'Mtar_canu_polca_Ratatosk', 'Mtar_canu_polca_Ratatosk', 'Mtar_canu_polca_Ratatosk', 'Mtar_wtdbg2_polca_Ratatosk', 'Mtar_wtdbg2_polca_Ratatosk', 'Mtar_wtdbg2_polca_Ratatosk', 'Mtar_wtdbg2_polca_Ratatosk', 'Mtar_masurca_polca_Ratatosk', 'Mtar_masurca_polca_Ratatosk', 'Mtar_masurca_polca_Ratatosk', 'Mtar_masurca_polca_Ratatosk', 'Mtar_Wtdbg2_Wtdbg2Suggested_Polca', 'Mtar_Wtdbg2_Wtdbg2Suggested_Polca', 'Mtar_Wtdbg2_Wtdbg2Suggested_Polca', 'Mtar_Wtdbg2_Wtdbg2Suggested_Polca')
my_species <- factor(my_species)
my_species <- factor(my_species,levels(my_species)[c(length(levels(my_species)):1)]) # reorder your species here just by changing the values in the vector :
my_percentage <- c(87.2, 0.5, 5.0, 7.3, 90.2, 3.9, 1.7, 4.2, 90.0, 0.2, 2.2, 7.6, 85.7, 1.3, 1.9, 11.1, 93.1, 0.3, 1.4, 5.2)
my_values <- c(5225, 28, 300, 438, 5404, 232, 101, 254, 5394, 12, 133, 452, 5137, 76, 112, 666, 5577, 15, 86, 313)
######################################
######################################
######################################
# Code to produce the graph
labsize = 1
if (length(levels(my_species)) > 10){
labsize = 0.66
}
print("Plotting the figure ...")
category <- c(rep(c("S","D","F","M"),c(1)))
category <-factor(category)
category = factor(category,levels(category)[c(4,1,2,3)])
df = data.frame(my_species,my_percentage,my_values,category)
write.table(df, '/Users/acas/Dropbox/Post-docs/Roux_Lab/genome_assembly/BUSCO_summaries_2polished/buscoOut.txt', quote = F, col.names = T, row.names = F, append = TRUE)
buscoOut <- read.table('/Users/acas/Dropbox/Post-docs/Roux_Lab/genome_assembly/BUSCO_summaries_2polished/buscoOut.txt', header = T)
head(buscoOut)
buscoOut1 <- buscoOut %>% select(-my_percentage)
library(tidyverse)
buscoOut1 <- buscoOut %>% select(-my_percentage)
buscoOut1 <- buscoOut %>% select(-my_percentage) %>% pivot_wider(names_from = category, values_from = my_values)
head(buscoOut1)
buscoOut1 <- buscoOut %>% select(-my_percentage) %>% pivot_wider(names_from = category, values_from = my_values) %>% separate(my_species,sep="_", into = c("species","assembler","polish1x","polish2x"))
head(buscoOut1)
write.table(buscoOut1, '/Users/acas/Dropbox/Post-docs/Roux_Lab/genome_assembly/BUSCO_summaries_2polished/buscoOut.txt', quote = F, col.names = T, row.names = F, sep = "\t")
# Load the required libraries
library(ggplot2)
library("grid")
# !!! CONFIGURE YOUR PLOT HERE !!!
# Output
my_output <- paste("Maeg/","busco_figure.png",sep="/")
my_width <- 20
my_height <- 15
my_unit <- "cm"
# Colors
my_colors <- c("#56B4E9", "#3492C7", "#F0E442", "#F04442")
# Bar height ratio
my_bar_height <- 0.75
# Legend
my_title <- "BUSCO Assessment Results"
# Font
my_family <- "sans"
my_size_ratio <- 1
# !!! SEE YOUR DATA HERE !!!
# Your data as generated by python, remove or add more
my_species <- c('Maeg_wtdbg2_Ratatosk', 'Maeg_wtdbg2_Ratatosk', 'Maeg_wtdbg2_Ratatosk', 'Maeg_wtdbg2_Ratatosk', 'Maeg_canu_polca', 'Maeg_canu_polca', 'Maeg_canu_polca', 'Maeg_canu_polca', 'Maeg_raven_Ratatosk', 'Maeg_raven_Ratatosk', 'Maeg_raven_Ratatosk', 'Maeg_raven_Ratatosk', 'Maeg_masurca_polca', 'Maeg_masurca_polca', 'Maeg_masurca_polca', 'Maeg_masurca_polca', 'Maeg_wtdbg2_polca', 'Maeg_wtdbg2_polca', 'Maeg_wtdbg2_polca', 'Maeg_wtdbg2_polca', 'Maeg_canu_Ratatosk', 'Maeg_canu_Ratatosk', 'Maeg_canu_Ratatosk', 'Maeg_canu_Ratatosk', 'Maeg_raven_polca', 'Maeg_raven_polca', 'Maeg_raven_polca', 'Maeg_raven_polca', 'Maeg_wtdbg2_wtdbg2Suggested', 'Maeg_wtdbg2_wtdbg2Suggested', 'Maeg_wtdbg2_wtdbg2Suggested', 'Maeg_wtdbg2_wtdbg2Suggested', 'Maeg_masurca_Ratatosk', 'Maeg_masurca_Ratatosk', 'Maeg_masurca_Ratatosk', 'Maeg_masurca_Ratatosk')
my_species <- factor(my_species)
my_species <- factor(my_species,levels(my_species)[c(length(levels(my_species)):1)]) # reorder your species here just by changing the values in the vector :
my_percentage <- c(55.6, 0.1, 8.7, 35.6, 91.1, 2.3, 2.0, 4.6, 87.2, 0.4, 5.4, 7.0, 83.6, 0.9, 1.9, 13.6, 68.4, 0.1, 5.8, 25.7, 90.6, 2.0, 2.4, 5.0, 88.9, 0.4, 4.3, 6.4, 79.4, 0.3, 3.5, 16.8, 83.0, 0.9, 2.2, 13.9)
my_values <- c(3329, 3, 519, 2140, 5458, 137, 121, 275, 5226, 23, 322, 420, 5008, 56, 112, 815, 4096, 8, 347, 1540, 5427, 122, 142, 300, 5327, 25, 259, 380, 4757, 15, 209, 1010, 4971, 55, 129, 836)
######################################
######################################
######################################
# Code to produce the graph
labsize = 1
if (length(levels(my_species)) > 10){
labsize = 0.66
}
print("Plotting the figure ...")
category <- c(rep(c("S","D","F","M"),c(1)))
category <-factor(category)
category = factor(category,levels(category)[c(4,1,2,3)])
df = data.frame(my_species,my_percentage,my_values,category)
write.table(df, '/Users/acas/Dropbox/Post-docs/Roux_Lab/genome_assembly/BUSCO_summaries_1polished/buscoOut.txt', quote = F, col.names = T, row.names = F, sep = "\t")
# Load the required libraries
library(ggplot2)
library("grid")
# !!! CONFIGURE YOUR PLOT HERE !!!
# Output
my_output <- paste("Mibe/","busco_figure.png",sep="/")
my_width <- 20
my_height <- 15
my_unit <- "cm"
# Colors
my_colors <- c("#56B4E9", "#3492C7", "#F0E442", "#F04442")
# Bar height ratio
my_bar_height <- 0.75
# Legend
my_title <- "BUSCO Assessment Results"
# Font
my_family <- "sans"
my_size_ratio <- 1
# !!! SEE YOUR DATA HERE !!!
# Your data as generated by python, remove or add more
my_species <- c('Mibe_masurca_polca', 'Mibe_masurca_polca', 'Mibe_masurca_polca', 'Mibe_masurca_polca', 'Mibe_raven_Ratatosk', 'Mibe_raven_Ratatosk', 'Mibe_raven_Ratatosk', 'Mibe_raven_Ratatosk', 'Mibe_masurca_Ratatosk', 'Mibe_masurca_Ratatosk', 'Mibe_masurca_Ratatosk', 'Mibe_masurca_Ratatosk', 'Mibe_canu_polca', 'Mibe_canu_polca', 'Mibe_canu_polca', 'Mibe_canu_polca', 'Mibe_wtdbg2_polca', 'Mibe_wtdbg2_polca', 'Mibe_wtdbg2_polca', 'Mibe_wtdbg2_polca', 'Mibe_wtdbg2_Ratatosk', 'Mibe_wtdbg2_Ratatosk', 'Mibe_wtdbg2_Ratatosk', 'Mibe_wtdbg2_Ratatosk', 'Mibe_wtdbg2_wtdbg2Suggested', 'Mibe_wtdbg2_wtdbg2Suggested', 'Mibe_wtdbg2_wtdbg2Suggested', 'Mibe_wtdbg2_wtdbg2Suggested', 'Mibe_canu_Ratatosk', 'Mibe_canu_Ratatosk', 'Mibe_canu_Ratatosk', 'Mibe_canu_Ratatosk', 'Mibe_raven_polca', 'Mibe_raven_polca', 'Mibe_raven_polca', 'Mibe_raven_polca')
my_species <- factor(my_species)
my_species <- factor(my_species,levels(my_species)[c(length(levels(my_species)):1)]) # reorder your species here just by changing the values in the vector :
my_percentage <- c(81.5, 1.4, 2.1, 15.0, 85.5, 0.4, 5.7, 8.4, 80.9, 1.3, 2.3, 15.5, 91.9, 0.6, 1.8, 5.7, 87.7, 0.2, 2.5, 9.6, 77.2, 0.2, 6.2, 16.4, 91.8, 0.3, 1.6, 6.3, 90.8, 0.6, 2.5, 6.1, 87.8, 0.4, 4.5, 7.3)
my_values <- c(4883, 84, 127, 897, 5124, 21, 339, 507, 4845, 78, 140, 928, 5503, 34, 110, 344, 5254, 10, 151, 576, 4625, 10, 370, 986, 5500, 16, 96, 379, 5438, 36, 148, 369, 5262, 21, 267, 441)
######################################
######################################
######################################
# Code to produce the graph
labsize = 1
if (length(levels(my_species)) > 10){
labsize = 0.66
}
print("Plotting the figure ...")
category <- c(rep(c("S","D","F","M"),c(1)))
category <-factor(category)
category = factor(category,levels(category)[c(4,1,2,3)])
df = data.frame(my_species,my_percentage,my_values,category)
write.table(df, '/Users/acas/Dropbox/Post-docs/Roux_Lab/genome_assembly/BUSCO_summaries_1polished/buscoOut.txt', quote = F, col.names = T, row.names = F, sep = "\t", append = T)
# Load the required libraries
library(ggplot2)
library("grid")
# !!! CONFIGURE YOUR PLOT HERE !!!
# Output
my_output <- paste("Mtar/","busco_figure.png",sep="/")
my_width <- 20
my_height <- 15
my_unit <- "cm"
# Colors
my_colors <- c("#56B4E9", "#3492C7", "#F0E442", "#F04442")
# Bar height ratio
my_bar_height <- 0.75
# Legend
my_title <- "BUSCO Assessment Results"
# Font
my_family <- "sans"
my_size_ratio <- 1
# !!! SEE YOUR DATA HERE !!!
# Your data as generated by python, remove or add more
my_species <- c('Mtar_canu_Ratatosk', 'Mtar_canu_Ratatosk', 'Mtar_canu_Ratatosk', 'Mtar_canu_Ratatosk', 'Mtar_wtdbg2_wtdbg2Suggested', 'Mtar_wtdbg2_wtdbg2Suggested', 'Mtar_wtdbg2_wtdbg2Suggested', 'Mtar_wtdbg2_wtdbg2Suggested', 'Mtar_masurca_Ratatosk', 'Mtar_masurca_Ratatosk', 'Mtar_masurca_Ratatosk', 'Mtar_masurca_Ratatosk', 'Mtar_canu_polca', 'Mtar_canu_polca', 'Mtar_canu_polca', 'Mtar_canu_polca', 'Mtar_wtdbg2_polca', 'Mtar_wtdbg2_polca', 'Mtar_wtdbg2_polca', 'Mtar_wtdbg2_polca', 'Mtar_raven_Ratatosk', 'Mtar_raven_Ratatosk', 'Mtar_raven_Ratatosk', 'Mtar_raven_Ratatosk', 'Mtar_wtdbg2_Ratatosk', 'Mtar_wtdbg2_Ratatosk', 'Mtar_wtdbg2_Ratatosk', 'Mtar_wtdbg2_Ratatosk', 'Mtar_masurca_polca', 'Mtar_masurca_polca', 'Mtar_masurca_polca', 'Mtar_masurca_polca', 'Mtar_raven_polca', 'Mtar_raven_polca', 'Mtar_raven_polca', 'Mtar_raven_polca')
my_species <- factor(my_species)
my_species <- factor(my_species,levels(my_species)[c(length(levels(my_species)):1)]) # reorder your species here just by changing the values in the vector :
my_percentage <- c(89.5, 3.7, 2.2, 4.6, 92.7, 0.2, 1.6, 5.5, 85.3, 1.2, 2.1, 11.4, 90.4, 3.9, 1.7, 4.0, 89.3, 0.2, 2.1, 8.4, 85.0, 0.6, 6.1, 8.3, 80.1, 0.2, 5.5, 14.2, 85.8, 1.3, 1.9, 11.0, 87.5, 0.5, 4.9, 7.1)
my_values <- c(5360, 220, 134, 277, 5555, 12, 98, 326, 5113, 72, 124, 682, 5414, 232, 99, 246, 5348, 12, 126, 505, 5094, 35, 367, 495, 4798, 10, 328, 855, 5138, 80, 112, 661, 5242, 27, 293, 429)
######################################
######################################
######################################
# Code to produce the graph
labsize = 1
if (length(levels(my_species)) > 10){
labsize = 0.66
}
print("Plotting the figure ...")
category <- c(rep(c("S","D","F","M"),c(1)))
category <-factor(category)
category = factor(category,levels(category)[c(4,1,2,3)])
df = data.frame(my_species,my_percentage,my_values,category)
write.table(df, '/Users/acas/Dropbox/Post-docs/Roux_Lab/genome_assembly/BUSCO_summaries_1polished/buscoOut.txt', quote = F, col.names = T, row.names = F, sep = "\t", append = T)
buscoOut <- read.table('/Users/acas/Dropbox/Post-docs/Roux_Lab/genome_assembly/BUSCO_summaries_1polished/buscoOut.txt', header = T)
buscoOut1 <- buscoOut %>% select(-my_percentage) %>% pivot_wider(names_from = category, values_from = my_values) %>% separate(my_species,sep="_", into = c("species","assembler","polish1x","polish2x"))
head(buscoOut)
head(buscoOut1)
buscoOut1 <- buscoOut %>% select(-my_percentage) %>% pivot_wider(names_from = category, values_from = my_values) %>% separate(my_species,sep="_", into = c("species","assembler","polish1x"))
write.table(buscoOut1, '/Users/acas/Dropbox/Post-docs/Roux_Lab/genome_assembly/BUSCO_summaries_1polished/buscoOut.txt', quote = F, col.names = T, row.names = F, sep = "\t")
